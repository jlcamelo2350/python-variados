## É o código utilizado para rodar a modelagem estatística apresentada no artigo Inovação, liberdade econômica e renda per capita
##disponível aqui nesse mesmo github, no repositório economics.
##link para a tabela utilizada: https://docs.google.com/spreadsheets/d/1HPi4ROGSVVqFbWX__KSOfus4xDDZujVr/edit?usp=drive_link&ouid=113535168983008940500&rtpof=true&sd=true

# Instala e carrega a biblioteca readxl para leitura de arquivos do Excel
install.packages("readxl")
library(readxl)
#Instala e carrega a biblioteca ggplot2 para gráficos
install.packages("ggplot2")
library(ggplot2)

# Define o caminho do arquivo Excel a ser lido
caminho <- "C:/Users/Alves/Downloads/reg/countries.xlsx" ##local onde está armazenado a tabela que utilizei para a modelagem

# Lê os dados do arquivo Excel
dados <- read_excel(caminho)

# Converte as colunas xI e xL para numérico para evitar problemas
dados$xI <- as.numeric(dados$xI)
dados$xL <- as.numeric(dados$xL)

# Cria-se o modelo de regressão com Y sendo a variável dependente, as colunas xI, xL contendo os valores das variáveis independentes e um erro randômico (rnorm)
dados$Y <- dados$xI + dados$xL + rnorm(nrow(dados))

# Cria modelos de regressão simples
regI <- lm(Y ~ xI, data = dados) ##Y como variável dependente e xI como variável independente
regL <- lm(Y ~ xL, data = dados)

# Mostra na tela os resultados da regressão simples (RLS):
summary(regI)
summary(regL)

# Cria um modelo de regressão múltipla
reg <- lm(Y ~ xI + xL, data = dados)

#Mostra na tela os resultados da RLM(múltipla):
summary(reg)


# Gráficos dos modelos:
# Modelo simples usando geom_smooth:
ggplot(dados, aes(x = xI, y = Y)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "red") +
  labs(x = "Inovação", y = "PIB per capita", title = "Regressão Linear: Inovação x PIB per Capita")

# Modelo simples usando geom_line
dados$pred <- predict(regL) # Estima os valores previstos para Y no modelo Y ~ xL
ggplot(dados, aes(x = xL, y = Y)) +
  geom_point() +
  geom_line(aes(y = pred), color = "blue") +
  labs(x = "Liberdade econômica", y = "PIB per capita", title = "Regressão Linear: Liberdade x PIB per Capita")

# Modelo múltiplo
ggplot(dados, aes(x = Y, y = predict(reg))) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "navy") +
  labs(x = "Valores Observados (Y)", y = "Valores Previstos (Y)", title = "Regressão Linear Múltipla: Inovação+Liberdade x PIB per Capita")
